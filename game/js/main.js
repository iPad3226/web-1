/*Canvas*/
const cvs = document.getElementById("canvas");
const ctx = cvs.getContext("2d");
cvs.width = 940;
cvs.height = 470;
var cnt = 0;
var game = 1;
var time = 0;
var cc = cnt;
var cg = game;
/*Canvas*/

/*Key*/
window.addEventListener("keydown", keyd)
window.addEventListener("keyup", keyu)
var inkey = new Array();
function keyd(e) {inkey[e.keyCode] = true}
function keyu(e) {inkey[e.keyCode] = false}
/*Key*/

/*Player*/
var player = new Image();
var x = 64;
var xspeed = 2;
var y = 256 + 128;
var vy = 0;
var jumpheight = 3;
var jump = true;
var cx = x
var cy = y
var cs = 0
/*Player*/

/*enemy*/
var enemy = new Image();
var ex = 128;
var ey = 128;
var cex = ex;
var cey = ey;
var evy = 0;
ejump=true;
turn=0;
cet=turn;
var espeed = 0.7;
ces = espeed;
/*enemy*/

/*bg*/
var background = new Image();
background.src = "./obj/background.png";
/*bg*/

/*Map*/
var key=false;
var ck = key;
var cp=false;
var map = new Array();
var screen = 0;
var once=true;
var co = once;
var mapchip = new Image();
makemap(screen);
function makemap(s) {
if (s==0){
mapchip.src = "./obj/tile.png";
map = [
//   -0-----------------------------1-----------------------------2--------------------------
//   -0--1--2--3--4--5--6--7--8--9--0--1--2--3--4--5--6--7--8--9--0--1--2--3--4--5--6--7--8
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,01],//00
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,01],//01
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,01],//02
	[00,00,00,00,00,00,00,00,00,08,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,01],//03
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,01],//04
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,01],//05
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,07],//06
	[00,00,00,00,00,00,00,00,00,07,00,00,00,00,09,00,00,00,00,07,00,00,00,00,00,00,00,00,00,07],//07
	[00,00,00,00,00,00,00,00,00,02,02,02,02,02,02,02,02,02,02,02,00,00,05,05,00,00,00,00,00,07],//08
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,06,00,00,00,00,00,05,00,00,00,00,00,00,00,00,07],//09
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,06,00,00,00,00,00,00,05,00,00,00,00,00,11,00,07],//10
	[02,00,00,00,00,00,00,00,00,00,00,00,00,00,06,00,00,00,00,00,00,00,00,00,02,03,00,05,00,02],//11
	[01,10,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,02,01,01,00,00,00,01],//12
	[01,02,02,02,02,02,02,02,02,03,00,00,04,02,02,02,03,00,00,00,00,00,02,01,01,01,00,00,00,01],//13
	[01,01,01,01,01,01,01,01,01,01,00,00,01,01,01,01,01,00,00,00,02,02,02,02,02,02,02,02,02,02] //14
];
}
else if (s==1){
key=false;
once=true;
mapchip.src = "./obj/tile.png";
map = [
//   -0-----------------------------1-----------------------------2--------------------------
//   -0--1--2--3--4--5--6--7--8--9--0--1--2--3--4--5--6--7--8--9--0--1--2--3--4--5--6--7--8
	[01,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//00
	[01,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//01
	[01,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//02
	[01,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//03
	[01,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//04
	[01,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//05
	[01,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//06
	[01,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//07
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//08
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//09
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//10
	[02,02,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//11
	[01,01,06,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,06,00,00,09,00,00,06,00,00],//12
	[01,01,02,02,02,02,02,02,02,03,00,00,04,02,02,02,03,00,00,00,02,02,02,02,02,02,02,02,02,02],//13
	[01,01,01,01,01,01,01,01,01,01,00,00,01,01,01,01,01,00,00,00,01,01,01,01,01,01,01,01,01,01] //14
];
}
else if (s==2){
once=true;
cp = false;
espeed = 4;
mapchip.src = "./obj/tile.png";
map = [
//   -0-----------------------------1-----------------------------2--------------------------
//   -0--1--2--3--4--5--6--7--8--9--0--1--2--3--4--5--6--7--8--9--0--1--2--3--4--5--6--7--8
	[01,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//00
	[01,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//01
	[01,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//02
	[01,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//03
	[01,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//04
	[01,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//05
	[01,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//06
	[01,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//07
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//08
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//09
	[00,00,00,00,00,00,00,00,00,00,00,00,06,00,00,00,06,00,00,00,00,06,00,00,00,00,00,00,00,00],//10
	[00,00,00,00,00,00,00,00,00,07,00,00,00,00,00,00,00,00,09,00,00,00,00,07,00,00,00,00,00,00],//11
	[00,00,00,00,00,00,11,00,00,07,00,00,00,00,00,00,00,00,00,00,00,00,00,07,00,00,00,00,00,00],//12
	[02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02],//13
	[01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01] //14
];
}
else if (s==3){
once=true;
espeed = 1;
mapchip.src = "./obj/tile.png";
map = [
//   -0-----------------------------1-----------------------------2--------------------------
//   -0--1--2--3--4--5--6--7--8--9--0--1--2--3--4--5--6--7--8--9--0--1--2--3--4--5--6--7--8
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//00
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//01
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//02
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//03
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//04
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//05
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//06
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//07
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//08
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//09
	[00,00,00,00,00,00,00,00,00,00,00,00,06,00,00,00,06,00,00,00,00,06,00,00,00,00,00,00,00,00],//10
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,09,00,00,00,00,00,00,00,00,00,00,00],//11
	[00,00,00,00,00,00,00,00,00,07,00,00,00,00,00,00,00,00,00,00,00,00,00,07,00,00,00,00,00,00],//12
	[02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02],//13
	[01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01] //14
];
}
else if (s==4){
once=true;
espeed = 1;
mapchip.src = "./obj/tile.png";
map = [
//   -0-----------------------------1-----------------------------2--------------------------
//   -0--1--2--3--4--5--6--7--8--9--0--1--2--3--4--5--6--7--8--9--0--1--2--3--4--5--6--7--8
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//00
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//01
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//02
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//03
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//04
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//05
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//06
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//07
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//08
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//09
	[00,00,00,00,00,00,00,00,00,00,00,00,06,00,00,00,06,00,00,00,00,06,00,00,00,00,00,00,00,00],//10
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,09,00,00,00,00,00,00,00,00,00,00,00],//11
	[00,00,00,00,00,00,00,00,00,07,00,00,00,00,00,00,00,00,00,00,00,00,00,07,00,00,00,00,00,00],//12
	[02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02],//13
	[01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01] //14
];
}
else if (s==5){
once=true;
espeed = 1;
mapchip.src = "./obj/tile.png";
map = [
//   -0-----------------------------1-----------------------------2--------------------------
//   -0--1--2--3--4--5--6--7--8--9--0--1--2--3--4--5--6--7--8--9--0--1--2--3--4--5--6--7--8
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//00
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//01
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//02
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//03
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//04
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//05
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//06
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//07
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//08
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00],//09
	[00,00,00,00,00,00,00,00,00,00,00,00,06,00,00,00,06,00,00,00,00,06,00,00,00,00,00,00,00,00],//10
	[00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,00,09,00,00,00,00,00,00,00,00,00,00,00],//11
	[00,00,00,00,00,00,00,00,00,07,00,00,00,00,00,00,00,00,00,00,00,00,00,07,00,00,00,00,00,00],//12
	[02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02,02],//13
	[01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01,01] //14
];
}
}
/*Map*/


//-----------------------------------------------------------------------------------------------//
function start() {
if (cnt == 0) {
	startse = new Audio("./sud/se/tyouetu.mp3");
	gaov = new Audio("./sud/se/yattenai.mp3");
	getk = new Audio("./sud/se/oyaa.mp3");
	getc = new Audio("./sud/se/nanda.mp3");
	bgm = new Audio("./sud/bgm/超越神力.mp3");
	startse.play();
	document.getElementById("startbtn").remove();
	cnt = 1;
	starttimer();
	upd()
}
function upd(){
if (once) {bgm.play()}
ctx.drawImage(background,0,0,940,470);
/*BLOCK*/
var bridgeX = new Array()
var bridgeY = new Array()
var spikeX = new Array()
var spikeY = new Array()
var blocksX = new Array()
var blocksY = new Array()
var enemyX = new Array()
var enemyY = new Array()
var keyX = new Array()
var keyY = new Array()
var cpX = new Array()
var cpY = new Array()
for (var my=0; my<map.length; my++){for (var mx=0; mx<map[my].length; mx++){
		if (map[my][mx] === 1) {ctx.drawImage( mapchip, 0, 0, 32, 32, 32*mx, 32*my, 32, 32 );blocksX.push(mx*32);blocksY.push(my*32)}
		if (map[my][mx] === 2) {ctx.drawImage( mapchip, 32, 0, 32, 32, 32*mx, 32*my, 32, 32 );blocksX.push(mx*32);blocksY.push(my*32)}
		if (map[my][mx] === 3) {ctx.drawImage( mapchip, 64, 0, 32, 32, 32*mx, 32*my, 32, 32 );blocksX.push(mx*32);blocksY.push(my*32)}
		if (map[my][mx] === 4) {ctx.drawImage( mapchip, 96, 0, 32, 32, 32*mx, 32*my, 32, 32 );blocksX.push(mx*32);blocksY.push(my*32)}
		if (map[my][mx] === 5) {ctx.drawImage( mapchip, 0, 32, 32, 32, 32*mx, 32*my, 32, 32 );bridgeX.push(mx*32);bridgeY.push(my*32)}
		if (map[my][mx] === 6) {ctx.drawImage( mapchip, 32, 32, 32, 32, 32*mx, 32*my, 32, 32 );spikeX.push(mx*32);spikeY.push(my*32)}
		if (map[my][mx] === 7&&!key==true) {ctx.drawImage( mapchip, 64, 32, 32, 32, 32*mx, 32*my, 32, 32 );blocksX.push(mx*32);blocksY.push(my*32)}
		if (map[my][mx] === 8&&!key==true) {ctx.drawImage( mapchip, 0, 64, 32, 32, 32*mx, 32*my, 32, 32 );keyX.push(mx*32);keyY.push(my*32)}
		if (map[my][mx] === 9&&once) {ex=32*mx, ey=32*my;}
		if (map[my][mx] === 10&&once) {x=32*mx, y=32*my;}
		if (map[my][mx] === 11&&!cp==true) {ctx.drawImage( mapchip, 96, 32, 32, 32, 32*mx, 32*my, 32, 32 );cpX.push(mx*32);cpY.push(my*32)}
}}
/*BLOCK*/

if (inkey[39]) {x=x+xspeed}
if (inkey[37]) {x=x-xspeed}
if (inkey[32]&&!jump) {vy=-jumpheight;jump=true}

/*key*/
for (var i=0;i<keyY.length;i++) {
	if (
	!inkey[32]&&
	y+32.001>keyY[i]&&
	y<keyY[i]&&
	x<keyX[i]+30&&
	x>keyX[i]-30
	) {key=true;getk.play()}
	else if (
	y+32>keyY[i]&&
	y<keyY[i]&&
	x<keyX[i]+30&&
	x>keyX[i]-30
	) {key=true;getk.play()}
	else if (
	y>keyY[i]&&
	y-32<keyY[i]&&
	x<keyX[i]+30&&
	x>keyX[i]-30
	) {key=true;getk.play()}
}

for (var i=0;i<keyX.length;i++) {
if (x>keyX[i]-32&&keyX[i]>x&&y>keyY[i]-32&&keyY[i]+32>y) {key=true;getk.play()}
else if (x>keyX[i]&&keyX[i]+32>x&&y>keyY[i]-32&&keyY[i]+32>y) {key=true;getk.play()}
}
/*key*/

/*cp*/
for (var i=0;i<cpY.length;i++) {
	if (
	!inkey[32]&&
	y+32.001>cpY[i]&&
	y<cpY[i]&&
	x<cpX[i]+30&&
	x>cpX[i]-30
	) {cp=true;savecp()}
	else if (
	y+32>cpY[i]&&
	y<cpY[i]&&
	x<cpX[i]+30&&
	x>cpX[i]-30
	) {cp=true;savecp()}
	else if (
	y>cpY[i]&&
	y-32<cpY[i]&&
	x<cpX[i]+30&&
	x>cpX[i]-30
	) {cp=true;savecp()}
}

for (var i=0;i<cpX.length;i++) {
if (x>cpX[i]-32&&cpX[i]>x&&y>cpY[i]-32&&cpY[i]+32>y) {cp=true;savecp()}
else if (x>cpX[i]&&cpX[i]+32>x&&y>cpY[i]-32&&cpY[i]+32>y) {cp=true;savecp()}
}
/*cp*/

/*block*/
jump=true
for (var i=0;i<blocksY.length;i++) {
	if (
	!inkey[32]&&
	y+32.001>blocksY[i]&&
	y<blocksY[i]&&
	x<blocksX[i]+30&&
	x>blocksX[i]-30
	) {y=blocksY[i]-32;jump=false}
	else if (
	y+32>blocksY[i]&&
	y<blocksY[i]&&
	x<blocksX[i]+30&&
	x>blocksX[i]-30
	) {y=blocksY[i]-32;jump=false}
	else if (
	y>blocksY[i]&&
	y-32<blocksY[i]&&
	x<blocksX[i]+30&&
	x>blocksX[i]-30
	) {y=blocksY[i]+32;vh=0}
}

for (var i=0;i<blocksX.length;i++) {
if (x>blocksX[i]-32&&blocksX[i]>x&&y>blocksY[i]-32&&blocksY[i]+32>y) {x=blocksX[i]-32}
else if (x>blocksX[i]&&blocksX[i]+32>x&&y>blocksY[i]-32&&blocksY[i]+32>y) {x=blocksX[i]+32}
}
/*block*/

/*Eblock*/
ejump=true
for (var i=0;i<blocksY.length;i++) {
	if (
	ey+32.001>blocksY[i]&&
	ey<blocksY[i]&&
	ex<blocksX[i]+30&&
	ex>blocksX[i]-30
	) {ey=blocksY[i]-32;ejump=false}
	else if (
	ey>blocksY[i]&&
	ey-32<blocksY[i]&&
	ex<blocksX[i]+30&&
	ex>blocksX[i]-30
	) {ey=blocksY[i]+32;evh=0}
}

for (var i=0;i<blocksX.length;i++) {
if (ex>blocksX[i]-32&&blocksX[i]>ex&&ey>blocksY[i]-32&&blocksY[i]+32>ey) {if (turn==1){turn=0} else {turn=1}}
else if (ex>blocksX[i]&&blocksX[i]+32>ex&&ey>blocksY[i]-32&&blocksY[i]+32>ey) {if (turn==1){turn=0} else {turn=1}}
}
/*Eblock*/

/*Espike*/
for (var i=0;i<spikeY.length;i++) {
	if (
	ey+32.001>spikeY[i]&&
	ey<spikeY[i]&&
	ex<spikeX[i]+30&&
	ex>spikeX[i]-30
	) {ey=spikeY[i]-32;ejump=false}
	else if (
	ey>spikeY[i]&&
	ey-32<spikeY[i]&&
	ex<spikeX[i]+30&&
	ex>spikeX[i]-30
	) {ey=spikeY[i]+32;evh=0}
}

for (var i=0;i<spikeX.length;i++) {
if (ex>spikeX[i]-32&&spikeX[i]>ex&&ey>spikeY[i]-32&&spikeY[i]+32>ey) {if (turn==1){turn=0} else {turn=1}}
else if (ex>spikeX[i]&&spikeX[i]+32>ex&&ey>spikeY[i]-32&&spikeY[i]+32>ey) {if (turn==1){turn=0} else {turn=1}}
}
/*Espike*/

/*bridge*/
for (var i=0;i<bridgeY.length;i++) {
	if (
	!inkey[32]&&
	y+32.001>bridgeY[i]&&
	y<bridgeY[i]&&
	x<bridgeX[i]+30&&
	x>bridgeX[i]-30
	) {y=bridgeY[i]-32;jump=false}
	else if (
	y+32>bridgeY[i]&&
	y<bridgeY[i]&&
	x<bridgeX[i]+30&&
	x>bridgeX[i]-30
	) {y=bridgeY[i]-32;jump=false}
}
/*bridge*/

/*spike*/
for (var i=0;i<spikeY.length;i++) {
	if (
	y+32>spikeY[i]&&
	y<spikeY[i]&&
	x<spikeX[i]+30&&
	x>spikeX[i]-30
	) {game=0}
	else if (
	y>spikeY[i]&&
	y-32<spikeY[i]&&
	x<spikeX[i]+30&&
	x>spikeX[i]-30
	) {game=0}
}

for (var i=0;i<spikeX.length;i++) {
if (x>spikeX[i]-32&&spikeX[i]>x&&y>spikeY[i]-32&&spikeY[i]+32>y) {game=0}
else if (x>spikeX[i]&&spikeX[i]+32>x&&y>spikeY[i]-32&&spikeY[i]+32>y) {game=0}
}
/*spike*/

/*enemy*/
if (
y+32>ey&&
y<ey&&
x<ex+30&&
x>ex-30
) {game=0}
else if (
y>ey&&
y-32<ey&&
x<ex+30&&
x>ex-30
) {game=0}
if (x>ex-32&&ex>x&&y>ey-32&&ey+32>y) {game=0}
else if (x>ex&&ex+32>x&&y>ey-32&&ey+32>y) {game=0}
/*enemy*/


if (jump) {y=y+vy;vy=vy+0.05}
if (ejump) {ey=ey+evy;evy=evy+0.05}
player.src = "./obj/player.png";
ctx.drawImage(player,x,y,32,32);
enemy.src = "./obj/enemy.png";
ctx.drawImage(enemy,ex,ey,32,32);

if (turn==1) {ex=ex+espeed} else if (turn==0) {ex=ex-espeed}

once=false


if (y>940) {game=0;}


if (x>940&&5>screen) {screen++;x=0;makemap(screen)} else if (x>940){game=2}
if (x<0) {x=0}

if (game==1) {window.requestAnimationFrame(upd)};
/*GAMEOVER*/
if (game==0) {bgm.pause();gaov.play();document.getElementById("TEXT").innerHTML = "ゲームオーバー";document.getElementById("cplo").remove();}
/*GAMEOVER*/
if (game==2) {document.getElementById("TEXT").innerHTML = "クリア Time["+time+"]";}
};
};

function savecp() {
	getc.play()
	cx = x;
	cy = y;
	ck = key;
	cc = cnt;
	cg = game;
	co = once;
	cs = screen;
	cex = ex;
	cey = ey;
	ces = espeed;
	cet = turn;
}

function loadcp(){
	x = cx;
	y = cy;
	key = ck;
	cnt = cc;
	game = cg;
	once = co;
	screen = cs;
	ex = cex;
	ey = cey;
	espeed = ces;
	turn = cet;
	document.getElementById("TEXT").innerHTML = "";
	game = 1;
	makemap(screen)
}


function starttimer() {
	function s1(){
		time++;
		document.getElementById("timer").innerHTML = "time["+time+"]";
		console.log(time)
		setTimeout(s1,1000)
	}
	s1();
}